<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Introduction to <em>declassification</em></title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Introduction to <em>declassification</em></h1>

<h3>Whole blood gene expression datasets</h3>

<p>There are 32 datasets of whole blood gene expression profiles used in building disease-specific classifiers. A summary description of these datasets is stored in <strong><em>d</em></strong> :</p>

<pre><code class="r">library(&quot;declassification&quot;);
data(d)
head(d);
</code></pre>

<pre><code>##                       compName      diseasetype platform caseNum
## 1        breastCancer_GSE16443     breastCancer  GPL2986      67
## 2 ColorectalCancer_E-MEXP-3756 ColorectalCancer   GPL570      20
## 3          lungCancer_GSE12771       lungCancer  GPL6102      97
## 4          lungCancer_GSE20189       lungCancer   GPL571      81
## 6                CRPC_GSE37199             CRPC   GPL570      63
## 8     SevereInfluenza_GSE20346  SevereInfluenza  GPL6947      19
##   controlNum geneNum
## 1         54   16752
## 2         20   21049
## 3         95   24614
## 4         80   13211
## 6         31   20618
## 8         36   19957
</code></pre>

<p>The expression matrix of each dataset is stored in <strong><em>exprML</em></strong> as a named list of gene by sample matrix. For instance, you can access gene expression data for <em>breastCancer_GSE16443</em> by </p>

<pre><code class="r">data(exprML)
dim(exprML[[&quot;breastCancer_GSE16443&quot;]])
</code></pre>

<pre><code>## [1] 16752   121
</code></pre>

<pre><code class="r">exprML[[&quot;breastCancer_GSE16443&quot;]][1:5,1:2]
</code></pre>

<pre><code>##          Signal_HB00951_3.7.06_1.28_PM Signal_HB009P4_5.30.06_10.22_AM
## 13CDNA73                     12.217144                       11.503113
## 182-FIP                      11.272632                       10.426918
## 2&#39;-PDE                        8.221201                        7.328341
## 3&#39;HEXO                        7.436064                        7.900735
## 384D8-2                      10.849428                       10.827291
</code></pre>

<p>The case and control sample IDs for each dataset are stored in <strong><em>sampleIDs</em></strong>. For instance, you can access case or control sample IDs for <em>breastCancer_GSE16443</em> as follows. </p>

<pre><code class="r">data(sampleIDs)
head(sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;casesamples&quot;]])
</code></pre>

<pre><code>## [1] &quot;Signal_HB0091A_3.9.06_11.59_AM&quot;  &quot;Signal_HB008VC_4.28.06_12.49_PM&quot;
## [3] &quot;Signal_HB006PL_5.15.06_8.37_AM&quot;  &quot;Signal_HB00950_2.16.06_2.51_PM&quot; 
## [5] &quot;Signal_HB006BG_3.21.06_1.14_PM&quot;  &quot;Signal_HB008VO_4.28.06_1.04_PM&quot;
</code></pre>

<pre><code class="r">head(sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]])
</code></pre>

<pre><code>## [1] &quot;Signal_HB00951_3.7.06_1.28_PM&quot;   &quot;Signal_HB009P4_5.30.06_10.22_AM&quot;
## [3] &quot;Signal_HB009P5_5.30.06_10.52_AM&quot; &quot;Signal_HB006BJ_3.9.06_10.57_AM&quot; 
## [5] &quot;Signal_HB009LZ_5.30.06_11.06_AM&quot; &quot;Signal_HB006UC_4.25.06_11.55_AM&quot;
</code></pre>

<h3>Estimation of cell components</h3>

<p>For each dataset, cell components can be estimated using either the algorithm <em>DSA</em> or <em>cibersort</em>. For the former, list of cell markers are needed as input. For the latter, basis matrix is needed.</p>

<pre><code class="r">data(marker)
compM&lt;-getcompM(exprML[[&quot;breastCancer_GSE16443&quot;]],method=&quot;DSA&quot;,marker=marker)
compM[,1]
</code></pre>

<pre><code>##            B-CD19      Erythroblast Granulocyte-CD66b     Megakaryocyte 
##        0.10724477        0.19512854        0.20493955        0.15886776 
##     Monocyte-CD14           NK-CD56             T-CD4             T-CD8 
##        0.15312927        0.03875897        0.11430521        0.04025118
</code></pre>

<h3>Estimation of residule profiles</h3>

<p>For each dataset,esidule profile for each sample can be calculated based on cell component profile estimated above.</p>

<pre><code class="r">resM&lt;-getresM(exprM=exprML[[&quot;breastCancer_GSE16443&quot;]],compM=compM,basesamples=sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]],method=&quot;NMF&quot;,uselogvalue=FALSE)
resM[1:5,1:2]
</code></pre>

<pre><code>##          Signal_HB00951_3.7.06_1.28_PM Signal_HB009P4_5.30.06_10.22_AM
## 13CDNA73                    -0.2576898                     -0.73818264
## 182-FIP                      0.3744254                     -0.01935057
## 2&#39;-PDE                      -0.3756736                     -0.92253640
## 3&#39;HEXO                      -1.3793025                     -0.51877453
## 384D8-2                      0.3829414                      0.12655689
</code></pre>

<h3>Z-transformation</h3>

<p>The features (original gene expression, cell component or residual expression) in each dataset can be Z-transformed (sample-wsie) to make different datasets more comparable.</p>

<pre><code class="r">ZresM&lt;-Ztransform(resM,sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]])
ZcompM&lt;-Ztransform(compM,sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]])
</code></pre>

<h3>Building disease-specific classifiers</h3>

<p>We provided wrapper functions for three classification algorithms, i.e., <em>ElasticNet</em>, <em>SVM</em> and <em>RandomForest</em>, and a function for feature selection. Users are welcome to use any other calssification functions and feature selction strategies. To build a disease-specific classifier, it is important to use other disease samples as controls. In the following example, we try to build a lung Cancer specific classifier. For illustration purpose, we only include breast cancer samples as controls, but other disease datasets can be added as control samples similarly. For simplicity, we trained the model using original gene expression profiles here. Component profiles and resdidual profiles estimated above can be used to train the model similarly.  </p>

<pre><code class="r">##combine training dataset
exprMbreast&lt;-Ztransform(exprML[[&quot;breastCancer_GSE16443&quot;]],sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]])
exprMlung&lt;-Ztransform(exprML[[&quot;lungCancer_GSE12771&quot;]],sampleIDs[[&quot;lungCancer_GSE12771&quot;]][[&quot;controlsamples&quot;]])
gg&lt;-intersect(rownames(exprMbreast),rownames(exprMlung))
train&lt;-cbind(exprMbreast[gg,],exprMlung[gg,])
##case sand control samples
casesamples&lt;-sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;casesamples&quot;]]
controlsamples&lt;-c(sampleIDs[[&quot;breastCancer_GSE16443&quot;]][[&quot;controlsamples&quot;]],unlist(sampleIDs[[&quot;lungCancer_GSE12771&quot;]]))
##training and testing samples
trainsamples&lt;-colnames(train)[sample(1:ncol(train),ceiling(ncol(train)/10*9))]
testsamples&lt;-setdiff(colnames(train),trainsamples)

##select top 200 features  
Index&lt;-featureselection(train,casesamples=intersect(trainsamples,casesamples),controlsamples=intersect(trainsamples,controlsamples),topN=200)

###train modle using ElasticNet
r&lt;-classificationElasticNet(train[Index,], casesamples=intersect(trainsamples,casesamples),controlsamples=intersect(trainsamples,controlsamples), testingsamples=testsamples) 
</code></pre>

<pre><code class="r">#####predicted probability in the testing samples
head(r$P)
</code></pre>

<pre><code>##  Signal_HB00953_2.16.06_3.06_PM  Signal_HB0095B_3.7.06_12.54_PM 
##                       0.6077485                       0.7934512 
## Signal_HB0090B_3.23.06_12.51_PM  Signal_HB006UO_4.6.06_10.29_AM 
##                       0.3483818                       0.4220547 
##  Signal_HB006PH_5.19.06_2.20_PM  Signal_HB006WG_4.25.06_9.48_AM 
##                       0.0227596                       0.1232579
</code></pre>

<pre><code class="r">####features selected by the classifier
head(r$siggenes)
</code></pre>

<pre><code>## [1] &quot;ZNF342&quot;   &quot;KIAA0247&quot; &quot;CDH13&quot;    &quot;RTN4&quot;     &quot;P2RY11&quot;   &quot;C18orf34&quot;
</code></pre>

</body>

</html>

